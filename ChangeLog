2002-11-21  Rolf Ade  <rolf@pointsman.de>

        * doc/expat.*: We don't have a 'provide expat' anymore, it's
          all tdom. Fixed a typo.

2002-11-17  Rolf Ade  <rolf@pointsman.de>

        * generic/domxslt.c: Report error, if xsl:import elements not
          come first.

        * doc/tnc.*: Better wording.
  
2002-11-16  Rolf Ade  <rolf@pointsman.de>

        * win/makefile.vc
        * extensions/tnc/makefile.vc: A bit final tweaking for 0.7.5.    

2002-11-16  Zoran Vasiljevic  <zoran@archiware.com>

	* generic/dom.h
	* generic/dom.c
	* generic/tcldom.c
	* generic/tclStubLib.c: fixed references to panic (now Tcl_Panic)
	  Also, fixed some 8.0.5 compilation issues.

        * README: added some 8.0.5 compilation notes

2002-11-16  Rolf Ade  <rolf@pointsman.de>

        * generic/tcldom.c: Fixed bugs, which only raised there head
          if compiled against tcl8.0.5.

        * tests/all.tcl  
        * tests/loadtdom.tcl
        * tests/domCmd.test
        * tests/domnamespace.test
        * tests/htmlreader.test
        * tests/i18n.test
        * tests/xmlsimple.test
        * tests/xslt.test: Made test suite also running under
          tcl8.0.5. Added constraint to the tests, which uses i18n tcl
          features.
        
        * doc/tnc.xml
        * doc/tnc.html
        * doc/tnc.n: Updated documentation.  

2002-11-15  Zoran Vasiljevic  <zoran@archiware.com>

	* generic/dom.h: added IS_DELETED node flag
	  Changed domFreeNode to accept one additional parameter.
	  This parameter is used to signal the function to 
	  perform node-walk and invoke user-supplied callback w/o
	  actually freeing the node. This functionality is required
	  for example when a thread detaches from the shared DOM tree
	  and wants to detach all eventual node commands from its
	  interpreter.
 	  Added "struct domNode *deletedNodes" in the document structure
	  This is the head of all nodes spliced out of the tree but not
	  yet free'd. This is needed in order to avoid memory trashing
	  when one thread deletes the node and the second thread still
	  holds the reference to it over the nodecmd command.
	  Added "struct domNode *nextDeleted" to maintain the list of
	  deleted nodes, as explained above.
	
	* generic/tcldom.c: introduced changes in the way nodes are
	  deleted from the tree in multi-threading shared-tree situations.
	  We now do not delete nodes having references from nodecmds from
	  different threads/interpreters. Instead, we put them on the 
	  deleted nodes list and tear-down this list when we delete the
	  document. 

	* generic/tcldom.c: when a thread detaches from the shared dom tree
	  it will now properly delete all commands attached to nodes.
	  Also, the dom object command barks when attempting to use already
	  deleted node (the node put on the deletion list).
	
2002-11-15  Rolf Ade  <rolf@pointsman.de>

        * tests/dom.test: Added some tests for as yet not covered node
          methods.

        * tests/htmlreader.test: Minor fix: added tcltest cleanup.

        * generic/tcldom.c: Changed 'attributes' method to return the
          empty string as result for non element nodes, according to
          the DOM 2 rec, chapter "Interface Node". Fixed a seg fault
          in hasAttributeNS. Closed a mem leak in appendXML.

        * lib/tdom.tcl: Added simple debugging feature to
          tDOM::extRefHandler.

2002-11-14  Zoran Vasiljevic  <zoran@archiware.com>

	* generic/tcldom.c: fixed UMR report from Purify

2002-11-12  Rolf Ade  <rolf@pointsman.de>

        * win/makefile.vc
        * extensions/tnc/makefile.vc: Updated to the new version nr
          and the lib name convention of the new TEA 2 build system.

2002-11-09  Rolf Ade  <rolf@pointsman.de>

        * generic/tcldom.c: HTML serializer: No content escaping for
          the HTML tags script and style, according to XSLT rec
          16.2. Fixed a memory problem during interp deletion.

        * generic/dom.c
        * generic/domxpath.c: Minor changes.

2002-11-03  Rolf Ade  <rolf@pointsman.de>

        * lib/tdom.tcl: tDOM::xmlOpenFile fix for files < 4 Byte size.    
        
        * generic/domxpath.c
        * generic/domxpath.h: Fixed ridiculously long runtime of
          certain // expr on certain documents. During analysis and
          testing, it turned out, that it would have been an even
          simpler approach, to simply expand the abbreviation // in
          the according productions. Though, the choosen implentation
          seems often to be (slightly) faster and is a start to
          collect experiences with early predicate evaluation.

2002-11-02  Zoran Vasiljevic  <zoran@archiware.com>

	* lib/tdomhtml.tcl: removed in favour of new tdom extension

	* extensions/tdomhtml: added new tdom extension for HTML
	  generation based on tdomhtml.tcl and internal tdom 
	  appendFromScript mechanism. This is a Tcl-only extension
	  which merely needs to be "make install"'ed.

	* Makefile.in: removed traces of tdomhtml.tcl file since it
	  now lives in its own extension

 	* configure.in:
	* configure: added TDOM_LD_SEARCH_FLAGS processing to help
	  runtime linker locate eventual custom shared libraries

2002-11-01  Rolf Ade  <rolf@pointsman.de>

        * Makefile.in: Fixed 'missing separator' problem (using tab
          instead of white space).

        * lib/tdom.tcl: Updated function-available, corrected
          ridiculous typo by my (element-avaliable ->
          element-available). Somewhat fixed and updated
          element-available.

        * generic/domxpath.c
        * test/xpath.c: Full qualified XPath function names now are
          accepted as syntactical correct expr. The function call is
          resolved to the Tcl proc
          dom::xpathFunc::<namespaceURI>::<functionLocalname>.

        * generic/dom.c
        * generic/dom.h
        * generic/domxslt.c
        * generic/nodecmd.c
        * generic/tcldom.c
        * test/xpath.test: Fixed old problem with Combine Set XPath
          expressions and XSLT sorts on trees, in which new nodes are
          inserted after the initial parsing (doc order of result).
    
2002-10-31  Zoran Vasiljevic  <zoran@archiware.com>

	* lib/tdom.tcl: does now "package require tdom" only,
	  instead of "package provide tdom 0.7.5".
	  The "package provide" with a correct version is
 	  done by the C-module now (which is better).
	  Some cosmetic changes as well (keep 80-columns wide!).

  	* lib/tdomhtml.tcl: renamed version of domhtml.tcl
	  Also did some simplification in html2tcl, renamed some
	  internal private functions and added namespace-wide 
	  definitions of html command names. The _2tcl procedure
	  now creates the missing elementNode commands as it
	  parses the html code, on the fly.

	* Makefile.in: changed order of loads in the pkgIndex.tcl.
	  First the C-module is loaded, followed by the tdom.tcl 
	  library file, followed by the tdomhtml.tcl library file.
 	  Thus, the tdomhtml.tcl has become the first class citizen.

	* CHANGES: added this file

2002-10-31  Rolf Ade  <rolf@pointsman.de>

        * generic/tcldom.c
        * test/dom.test: Fixed argument check of domObj method
          documentElement. Fixed domNode method appendFromList (wrong
          list format could result in seg fault). Thanks to Oleg
          Oleinick, for reporting both problems.

        * generic/domxslt.c
        * generic/domxpath.c
        * generic/dom.c: Fixed mem leaks/possible invalid read
    
2002-10-30  Zoran Vasiljevic  <zoran@archiware.com>

	* generic/domxslt.c: added proper cast to arguments passed to
	  FREE() macro to avoid compiler barking at us.

2002-10-30  Rolf Ade  <rolf@pointsman.de>

        * generic/tcldom.c: Added -escapeNonASCII and -htmlEntities
          also to node_usage and domObj_usage.

        * extensions/tnc/test.tcl: Updated to use new tDOM
          features. Made more usable.    

        * apps/xslt.tcl: Updated to using domDoc xslt method,
          -escapeNonASCII for asXML and asHTML and additionally
          -htmlEntities for asHTML.

	* generic/domxslt.c: Implemented "Forwards-Compatible
          Processing" (XSLT rec 2.5), with limitations: xsl:version
          attributes on literal result elements are not
          supported. Fixed a bug in XPath func
          format-number(). XsltProcess now accepts also a
          domDoc. Improved the setting of the documentElement of the
          resultDoc.

2002-10-29  Rolf Ade  <rolf@pointsman.de>

	* generic/tcldom.c:
        * doc/domDoc.*
        * doc/domNode.*: Added -escapeNonASCII as option to the asXML
          and asHTML methods and -htmlEntities as option to the asHTML
          method. Added "xslt" method to domDoc commands.

	* generic/dom.c: Better error reporting in case of parsing
          errors in external entities.

        * doc/expat.*: Fixed a documentation bug.
  
2002-10-29 Zoran Vasiljevic <zoran@archiware.com>

	* generic/tcldom.c
	* generic/nodecmd.c
	* generic/nodecmd.h: modified "dom createNodeCmd" to accept the
        -returnNodeCmd" optional argument. All commands created
	with this option willreturn the dom object command for accessing 
	the generated node.
	
	* ChangeLog: added this file
